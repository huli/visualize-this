<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
<style>

body{
  max-width: 900px;
  margin: 0px auto;
  font-family: 'Merriweather', serif;
}

#container{
  position: relative;
}

#sections{
  width: 340px;
}

#sections > div{
  background: white;
  opacity: .2;
  margin-bottom: 200px;
}
#sections > div:last-child{
  margin-bottom: 30px;
}
#sections > div.graph-scroll-active{
  opacity: 1;
}

#graph{
  margin-left: 40px;
  width: 500px;
  position: absolute;
  top: 0px;
  margin-left: 380px;
  margin-top: 20px;
}

.graph-scroll-fixed #graph{
  position: fixed;
  top: 0px;
}

.graph-scroll-below #graph{
  bottom: 0px;
  top: auto;
}

@media (max-width: 925px)  {
  #graph{
    width: 100%;
    transform: translate(-50%, 0);
    margin-left: 50%;
  }

  #sections{
    position: relative;
    margin: 0px auto;
    padding-top: 400px;
  }

  #sections div{
    background: rgba(255,255,255,.5);
    padding: 10px;
    border: 1px solid;
    max-width: 400px;
    margin-bottom: 500px;
  }
}

h1{
  margin: 50px;
}

h1, h3{
  text-align: center;
}

circle{
  fill: steelblue;
}

.mono{
  font-family: monospace;
}

svg{
  /*background-color: #eee;*/
}

</style>

<h1>Scrollytelling</h1>
<h3>Simple scrolling events for d3 graphics.</h3>

<br/>
<br/>
<br/>
<div id='container'>
    <div id='graph'></div>
    <div id='sections'>
        <div>
            Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
            sed diam voluptua. At vero eos et accusam et
        </div>
        <div>
            Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
            sed diam voluptua. At vero eos et accusam et
        </div>
        <div>
        </div>
    </div>
</div>

<div id='container'>
    <div id='graph'></div>
    <div id='sections'>
        <div>
            Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
            sed diam voluptua. At vero eos et accusam et
        </div>
        <div>
            Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
            sed diam voluptua. At vero eos et accusam et
        </div>
        <div>
        </div>
    </div>
</div>


<div id='container'>
    <div id='graph'></div>
    <div id='sections'>
        <div>
            Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
            sed diam voluptua. At vero eos et accusam et
        </div>
        <div>
            Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
            sed diam voluptua. At vero eos et accusam et
        </div>
        <div>
            Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
            sed diam voluptua. At vero eos et accusam et
        </div>
    </div>
</div>
    
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
this is the end




<script src="d3v4+jetpack.js"></script>
<script src="graph-scroll.js"></script>
<script>
  
  var colors = ['orange', 'purple', 'green', 'pink', 'black', 'yellow', 'grey'];
  
  var oldWidth = 0
  function render(){
     if (oldWidth == innerWidth) return
    oldWidth = innerWidth

    var width = d3.select('#graph').node().offsetWidth,
        height = innerWidth > 925 ? width : innerHeight*.7,
        r = 40

    var svg = d3.select('#graph').html('')
      .append('svg')
        .attrs({width: width, height: height})

    var circle = svg.append('circle')
        .attrs({cx: 0, cy: 0, r: r});

    d3.graphScroll()
        .sections(d3.selectAll('#sections > div'))
        .on('active', 
            function(i)
            { 
              var pos = [ {cx: width - r, cy: r},
                          {cx: r,         cy: r},
                          {cx: width - r, cy: height - r},
                          {cx: width/2,   cy: height/2} ][i%4]
              
              console.log(pos);
              
              circle.transition().duration(1000)
                  .attrs(pos)
                .transition()
                  .style('fill', colors[i%7])
            });

    d3.select('#source')
        .styles({'margin-bottom': window.innerHeight - 450 + 'px', padding: '100px'});

  }
  render()
  d3.select(window).on('resize', render)
</script>
